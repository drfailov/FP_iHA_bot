https://github.com/drfailov/FP_iHA_bot


TODO:

Вкладка для отправки сообщений боту
Очередь на отправку сообщений
Очередь на выгрузку документов
Автозагрузка
отдельный раздел с уведомлениями, для ошибок
Команда "запомни": где я пересылаю ему мем и он вносит его в базу
В базе есть вопросы типа этих https://vk.com/audio, предполагающие что пользователь отправил медиа
отправка фалов (документов) размером более 50мб
страница где можно назначить администраторов

Сейчас я пробую сделать, чтобы:
07.04.2022 работали команды впринципе
07.04.2022 Задача на сегодня: админка. Список админов, права доступа, принятие команд.
08.04.2022 И ещё одна: по приёму бот должен делать "Печатает..."
08.04.2022 Чтобы бот умел отправлять файлы
09.04.2022 переделал формат вложений - теперь у каждого вложения есть целый список загруженных в онлайн сущностей - отдельнвя для кажого бот аккаунта
09.04.2022 Команда "помощь" каскадом собирает данные
10.04.2022 команда дампа базы
10.04.2022 Чтобы базу можно было сохранить в резервную копию
10.04.2022 план на завтра - отправка файлов больше 50мб
11.04.2022 Чтобы можно было отправлять такую команду "запомни"
11.04.2022 Чтобы фотки скачивались и ложились в базу
11.04.2022 Чтобы данные вносились в базу
11.04.2022 исправлено При обучении последовательность ответа и вопроса неоднозначна
12.04.2022 Команда для просмотра диапазона ответов
12.04.2022 Команда для просмотра конкретного ответа
12.04.2022 Отправка фото с форматированием HTML
12.04.2022 Отправка документов с форматированием HTML
14.04.2022 Если возникает ошибка обработки команды, ответ из базы уже не подбирается
14.04.2022 команда для удаления ответа из базы по ID (команда "забудь")
14.04.2022 Команда для очистки неиспользуемых вложений в базе
14.04.2022 Добавлена защита от переполнения по длине вывода команды "ответы"
14.04.2022 воспринимать редактированные сообщения как новые
14.04.2022 removeAnswersFromDatabase переделана на работу с массивами для большей универсальности
14.04.2022 если в обьекте Message есть обьект ответного сообщения, он будет отправлен как ответ.

14.04.2022 Чтобы бот отправлял сообщения как ответы в диалоге
14.04.2022 Исправлена причина по которой вылетала программа при открытии списка аккаунтов
14.04.2022 скачивание стикеров как фотографий при обучении
14.04.2022 Дополнена обработка исключений при работе с командами
16.04.2022 Резервная копия базы данных теперь включает в себя синонимы
16.04.2022 Для администраторов теперь добавлены права доступа. Они ещё не используются и не изменяются. Они просто есть.
16.04.2022 Новая команда "Ответы на". Выводит список ответов которые бот мог бы использовать при ответе на вопрос и вероятность того что ответ подходит.
16.04.2022 Бот обновляет информацию о частоте использования ответов в базе каждые 10 вопросов
16.04.2022 Исправления в команде "ответ"
17.04.2022 Добавлена защита, которая даже в случае возникновения конфликта потоком не даут угробить базу ответов при редактировании
17.04.2022 Добавлено большн защит
17.04.2022 Исправлены мелкие ошибки
17.04.2022 реализована команда загрузки файлов во временную папку
17.04.2022 чистка временных файлов теперь предполагает что там могут быть папки и сможет рекурсивно их почистить.
17.04.2022 Начато написание команды восстановления базы
17.04.2022 подстройка алгоритмов подбора ответов
18.04.2022 Переписан алгоритм подбора ответа
19.04.2022 Написана команда "восстановить базу"
19.04.2022 Начато написание команды добавления администратора
20.04.2022 Планы на добавление администратора сломаны, начинаю всё переделывать
20.04.2022 К инфе про администратора добавлена дата добавления
20.04.2022 Наброски нового плана добавления админа
21.04.2022 Начато написание механизма ведения статистики сообщений
21.04.2022 Сообщения формируют структуры данных, они сохраняются в файл и читаются оттуда.
21.04.2022 Есть команда формирования списка последних чатов для аккаунта
21.04.2022 Команда "админ добавить" теперь выводит список последних чатов
23.04.2022 Найдена и устранена ошибка, из-за которой при ошибках сначала глючил интерфейс программы, а потом она вылетала
23.04.2022 Теперь по умолчанию открывается экран с аккаунтами
23.04.2022 Созданы функции для поиска по пользователям в истории
23.04.2022 Начат тупик переосмысления работы команд
23.04.2022 Немного подвигал классы
24.04.2022 добавлена обработка команды добавления админа
24.04.2022 добавлена защита от отправки текста длиннее 4000 символов
24.04.2022 Команда "Админ"
24.04.2022 Команда "Админ добавить @drfailov"
24.04.2022 Команда "Админ @drfailov"
24.04.2022 Администрация: обжалование администратора


- проверка во всех командах наличия права доступа на использование
- команда на добавление синонима
- отправка фотографий если они были загружены на сервер
- Работа с вложениями типа "музыка"
- Работа с вложениями типа "видео"
- Оптимизация подбора ответа
- Команда для вывода топа ответов самых часто используемых
Команда "ответы с" ищет где в ответах содержится какое-то ключевое слово
Команда "Админ разрешить @drfailov редактирование базы"
Администрация: управление правами
Администрация: история команд администратора
Синонимы: просмотр
Синонимы: редактирование


248067313 
914020479 


чтоб добавить сообщение, надо три сообщения
"запомни"
потом следующим вопрос
Максимум юмора, можно жестокости.
Старайся в ответах не упоминать пол собеседника и пол бота. 
Если пол всё же неизвежно упомянуть, пол бота и собеседника - мужской.
При подборе ответа учитывается наличие в вопросе наличие знака вопроса.
И следующим ответ (можно стикером)
если ты добавила какую-то херню, воспользуйся комагдой "забудь"
ID ответов в ответах на команды кликабельны









коэффициент совпадения вопроса с вопросом из базы и его связь с удачностью этого ответа
600000 OK
533750 OK
529722 BAD
518571 ОК
516984 BAD
503333 BAD
480139 ОК



бот, стих
бот, частушки



Got response: {"ok":true,"result":[{"update_id":784436564,
    "message":{"message_id":630,"from":{"id":248067313,"is_bot":false,"first_name":"Dr","last_name":"Failov","username":"DrFailov","language_code":"ru"},"chat":{"id":248067313,"first_name":"Dr","last_name":"Failov","username":"DrFailov","type":"private"},"date":1648752657,"text":"\u0425\u0443\u0439\u043b\u043e"}}]}